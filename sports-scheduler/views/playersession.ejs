<style>
    /* Container styles */
    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }

    /* Table styles */
    table {
        width: 100%;
        border-collapse: collapse;
        background-color: #ffffff;
        box-shadow: 0 0 10px skyblue;
        border-radius: 4px;
        overflow: hidden;
    }

    th,
    td {
        padding: 12px 15px;
        text-align: left;
    }

    th {
        background-color: skyblue;
        font-weight: bold;
    }

    tbody tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    /* Heading styles */
    h1 {
        text-align: center;
        color: #333333;
        margin-bottom: 20px;
    }

    /* No sessions message */
    .no-sessions {
        text-align: center;
        font-style: italic;
        color: #888888;
        margin-top: 20px;
    }

    .empty-slots {
        font-size: 12px;
        color: #888888;
        display: inline-block;
        margin-left: 10px;
    }

    .joined-status {
        font-size: 12px;
        color: green;
    }

    .past-session {
        color: red;
    }

    .past-session a {
        pointer-events: none;
        color: #888888;
        cursor: not-allowed;
    }
</style>

<div class="container">
    <h1>
        <%= title %>
    </h1>
    <a href="/player" class="text-blue-500">Back</a>
    <% if (data.length===0) { %>
        <p class="no-sessions">No sessions available.</p>
        <% } else { %>
            <% data.forEach(session=> { %>
                <% const hasJoined=session.joined ? session.joined.includes(loggedInUser) : false; %>
                    <% const sessionTime=new Date(session.time); %>
                        <% const currentTime=new Date(); %>
                            <% const isPastSession=sessionTime < currentTime; %>
                                <% if (!session.cancel_status) { %>
                                    <div>
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Venue</th>
                                                    <th>Number of Teams</th>
                                                    <th>Number of Players</th>
                                                    <th>Player Names</th>
                                                    <th>Time</th>
                                                    <th>Organizer</th>
                                                    <th>Join</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr <% if (isPastSession) { %> class="past-session" <% } %>>
                                                        <td>
                                                            <%= session.id %>
                                                        </td>
                                                        <td>
                                                            <%= session.venue %>
                                                        </td>
                                                        <td>
                                                            <%= session.teamcount %>
                                                        </td>
                                                        <td>
                                                            <%= session.playercount %>
                                                        </td>
                                                        <td>
                                                            <%= session.playernames %>
                                                        </td>
                                                        <td>
                                                            <%= session.time.toISOString() %>
                                                        </td>
                                                        <td>
                                                            <% const organizerIndex=userIds.indexOf(session.userId); %>
                                                                <%= organizerIndex !==-1 ? usernames[organizerIndex]
                                                                    : 'Unknown Organizer' %>
                                                        </td>
                                                        <td>
                                                            <% const emptySlots=session.playercount -
                                                                (session.playernames ?
                                                                session.playernames.split(',').length : 0); %>
                                                                <% if (isPastSession) { %>
                                                                    <span class="empty-slots">Past Session</span>
                                                                    <% } else if (emptySlots> 0) { %>
                                                                        <% if (hasJoined) { %>
                                                                            <span class="joined-status">Joined</span>
                                                                            <% } else { %>
                                                                                <a
                                                                                    href="/join?sessionId=<%= session.id %>&username=<%= username %>">Join</a>
                                                                                <span class="empty-slots">
                                                                                    <%= emptySlots %> empty slots
                                                                                </span>
                                                                                <% } %>
                                                                                    <% } else { %>
                                                                                        <span class="empty-slots">No
                                                                                            slots available</span>
                                                                                        <% } %>
                                                        </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <% } %>
                                        <% }); %>
                                            <% } %>
</div>

<div class="container">
    <a href="/create-session" class="text-blue-500">Create a Session</a>
</div>